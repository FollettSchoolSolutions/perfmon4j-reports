<body>
<div ng-controller="sideNavControl" layout="row" flex="flex">
    <md-sidenav id="sidenav" class="md-sidenav-left md-whiteframe-z2" md-component-id="left" md-is-locked-open="isToggled()">
      	<div class="md-theme-indigo" id="sidenavHeader">
      		<span class="headerText">Chart Information</span>
      	</div>
		<div>	
			<label class="inputHeading" for="chartName">Chart Name <span class="required">*</span></label>
				<input class="chartInput" type="text" ng-model="chart.chartName" placeholder="Name of chart" value="" id="chartName" name="chartName" ng-blur="saveChartName()"/>
			<label class="inputHeading" for="datasource">Data Source <span class="required">*</span></label>
				<select class="chartInput" ng-options="datasource as datasource.name for datasource in datasources" id="datasource" ng-model="chart.chosenDatasource" ng-disabled="disableTopOptions()" ng-change="loadDatabases()"></select>
			<label class="inputHeading" for="database">Database <span class="required">*</span></label> 
				<br/>
				<select class="chartInput" id="database" ng-options="database as database.name for database in databases" ng-model="chart.chosenDatabase" ng-disabled="disableTopOptions()" ng-change="initSeries()">
					<option value="">Select a database</option>
				</select><img src="images/smallLoadingSaving.gif" ng-show="isLoading(chosenDatasource, databases)">
      		<div layout="row">
	      		<div class="start">
	      			<label for="startTime" class="inputHeading">From: <span class="required">*</span></label>
	      			<input class="from" name="startTime" type="text" id="startTime" ng-model="chart.timeStart"/>
	      		</div>
	      		<div class="end">
	      			<label for="endTime" class="inputHeading">To: <span class="required">*</span></label>
	      			<input class="to" type="text" name="endTime" id="endTime" ng-model="chart.timeEnd"/>
	      		</div>
	      		<span class="infoIconSpanChartDate" layout="column">
					<span flex="flex"></span>
					<a title="Date Range Syntax" href="https://github.com/FollettSchoolSolutions/perfmon4j-reports/wiki/Date-Range-Parameter-Syntax" target="_blank" class="infoIconAnchorChartDate"> 
						<i class="material-icons">info</i>
					</a>
				</span>
      		</div>
      		<div layout="row">
	      		<input type="checkbox" name="publiclyVisible" ng-model="chart.publiclyVisible"/>
	      		<label class="centeredLabelText" for="publiclyVisible"> Public?</label> 
      		</div>
      		<a title="Advanced Options"><md-button title="Advanced Options" id="advanced" class="md-raised md-primary" ng-click="showAdvanced($event)">Advanced Options</md-button></a>
			<div class="form" ng-repeat="item in chart.series" >
				<chart-series all-series="chart.series" series="item" ng-click="setActiveSeries($index)"></chart-series>
		  	</div>
		  	<span class="seriesNameError" ng-show="invalidSeriesNames()">Cannot have matching series names.</span>
		  	<div class="addSeriesRow" layout="row">
		  		<a title="Add Series"><md-button title="Add Series" id="addSeries" class="md-raised md-primary" ng-disabled="renderDisabled()" ng-click="addSeries()">Add Another Series</md-button></a>
		  	</div>

	  		<a title="Render"><md-button title="Render" id="renderChart" ng-disabled="renderDisabled()" ng-click="showChart()" class="md-raised md-primary">Render</md-button></a>
        	<a title="Save"><md-button title="Save or Update" id="save" ng-disabled="saveDisabled()" class="md-raised md-primary" ng-click="saveOrUpdateChart()"> {{ saveOrUpdateChartLabel }} </md-button></a>
        	<a title="Clear"><md-button title="Clear" id="clear" ng-click="clearAllFields()" class="md-raised">Clear</md-button></a>
        	
       	</div>
    </md-sidenav>	    
    <md-content class="md-accl chart-view not-scrollable" flex="flex">
    	<div ng-if="isViewOnly()">
      		<md-button ng-click="viewParameterInfo($event)" class="md-raised md-primary"> INFO </md-button>
      	</div>
 		<div layout="row">
	 		<a class="tabText" title="Toggle Menu Bar">
	 			<div layout="column" ng-show="showToggleButton()" ng-click="toggleSideNav()" id="openConfig" class="btn">{{sideNavToggle()}}</div>
	 		</a>
     		<div layout="column" ng-controller="chartRenderControl" class="chartDiv"> 
     			<img src="images/loadingSaving.gif" ng-show="isChartLoading()" class="centered">
     			
     			<div ng-show="isShowable()">
     				<div ng-show="isSuccessfullySaved() != null && isSuccessfullySaved()">
						<p class="saveConfirmation"> {{ getSaveConfirmationLabel() }} </p>
					</div>
					<div ng-show="isSuccessfullySaved() != null && (!isSuccessfullySaved())" >
						<p class="saveFailure">Failed to save the chart.</p>
					</div><br/>
					<p class="chartName"> {{name()}} </p>
					<div id="chart"></div>
					
					<div class="viewTimeDiv" layout="row" layout-align="center center">
			      		<div>
			      			<label for="startTime">From:</label>
			      			<input class="from viewTimeParamInput" name="startTime" type="text" id="startTime" ng-model="chart.timeStart"/>
			      		</div>
			      		<div>
			      			<label for="endTime">To:</label>
			      			<input class="to viewTimeParamInput" type="text" name="endTime" id="endTime" ng-model="chart.timeEnd"/>
			      		</div>
			      		<span class="" layout="column">
							<a title="Date Range Syntax" href="https://github.com/FollettSchoolSolutions/perfmon4j-reports/wiki/Date-Range-Parameter-Syntax" target="_blank" class="viewTimeSyntaxIcon"> 
								<i class="material-icons">info</i>
							</a>
						</span>
						<md-button title="Render" id="renderChart" ng-disabled="!timeParamsPopulated()" ng-click="showChart()" class="md-raised md-primary">Render</md-button>
						<!-- MAKE ng-disabled DO THINGS -->
		      		</div>
				</div>
			</div>
		</div>
   	</md-content>
</div>
</body>
